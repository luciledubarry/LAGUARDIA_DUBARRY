---
title: "Data Management Project"
format: html
message: false
code-fold: true
echo: false
---

```{r}
#| message : false 
here::i_am("LAGUARDIA_DUBARRY.Rproj")
library(ggplot2)
library(dplyr)
library(tidyr)
library(vroom)
library(here)
```

```{r}
#| message: false
museum <- vroom(here("musees-de-france-base-museofile.csv"))
freq <- vroom(here("frequentation-des-musees-de-france.csv"))
```

## Link to Github

We work on the Github project, available [here](https://github.com/luciledubarry/LAGUARDIA_DUBARRY.git).

## Sources

Both our data sets come from the **French Ministry of culture**. Since 2011, the Ministry of culture has set up both a public data census service and a data sharing service, open to all citizens, researchers, students, journalists, and companies. Its aim is to improve the exposure of cultural works and French cultural institutions. Even though it is a legal obligation since 2018 for administrations to open up their data, there are a lot of benefits from sharing these data: full transparency with the citizens, support for social innovations, boosting the local economy through discovering local cultural institutions, boosting France international influence etc.

Our first data set, **"Musées de France: base Muséofile"**, features all the museums that have been given the "Musée de France" label by the *Code du Patrimoine*. A "Musée de France" is, in accordance with the *Code du Patrimoine*, a "permanent collection made up of items whose conservation and presentation are of public interest, and organized for the knowledge, education and enjoyment of the public". As we'll see later, it contains basic information on these museums (such as the address, the website or the year of creation), as well as interesting complementary characteristics (such as the main theme of the museum, its most important asset or the leading artist of its permanent collection).

Our second data set, **"Fréquentation des musées de France"**, contains the number of visitors each year, from 2001 to 2021.

The advantage of gathering databases from the same website and the same institution of origin is that the merging will be a lot easier, due to the fact that they have variables in common. What's more, the source being the Ministry of culture gives us the assurance that the data has been collected correctly.

The **"Musées de France: base Muséofile"** dataset is available [here](https://www.data.gouv.fr/fr/datasets/musees-de-france-base-museofile/#/resources)

The **"Fréquentations des musées de France"** dataset is available [here](https://www.data.gouv.fr/fr/datasets/frequentation-des-musees-de-france-1/#/resources)

## Short description of the data files

In this table, you'll find some basic information about our first data file **"Musées de France: base Muséofile"**.

```{r}
info_museum <- museum |>
  summarise(NROW(museum),NCOL(museum))
knitr::kable(info_museum, format = "html",col.names = c("Number of rows (number of museums","Number of columns (characteristics)"))
```
In this other table, you'll find the same basic information for our second data file **"Fréquentations des musées de France"**.
```{r}
info_freq <- freq |>
  summarise(NROW(freq), NCOL(freq))
knitr::kable(info_freq, format = "html",col.names = c("Number of rows", "Number of columns"))
```

## Description of each variable

### 1st data set - Musée de France: base Muséofile:
REF : Muséofile reference code ; 
NOMOFF : Official name of the museum ; 
AUTNOM : Customary name of the museum;
ADRL1_M : Adress ; 
LIEU_M : Specifications of the adress ; 
CP_M : Postal code ;
VILLE_M : City ; 
DPT : Department ; 
REGION : Region ; 
URL_M : Website or page address ;  
TEL_M : Phone number of the museum ; 
CATEG: Specific museum category; 
DOMPAL: Main themes of the collections; 
HIST: History of the collection; 
ATOUT: Assets of the collection; 
THEMES: Details of the themes  of the collections; 
ARTIST: Leading artists of the collection; 
PHARE: Leading personalities of the collection;
INTERET: Architectural feature of the building;
PROT-BAT: Type of building preservation;
PROT-ESP: Type of space preservation;
REFMER: Reference code in the Mérimée database;
AN-CREAT: Year of creation;
DMAJ: Date of the last information update; Latitude; Longitude.

### 2nd data set - Fréquentation des musées de France:
REF_MUSEE: Museum reference code;
NOM_DU_MUSEE: Museum official name;
ANNEE: Year of update;
REGIONS: Region;
VILLE: City;
DATE_APPELLATION: Date on which controlled museums receive the designation “Musées de France”, since February 2003
PAYANT: Number of visits with paid entrance ticket;
GRATUIT: Number of visits with free entrance ticket;
TOTAL: Total of number of visits (PAYANT + GRATUIT);
NOTE: indicates: 
- "F": the museum is closed; 
- "NC": no frequentation data have been provided; 
- "R": withdrawal of the "Musées de France" designation.
ID_MUSEOFILE: Muséofile reference code ; 
NOMDEP: Department;
OBSERVATIONS: Some sites communicate the cumulative frequentation for all the museums on the site. The "OBSERVATIONS" column contains the references of the museums whose frequentation is aggregated (see "REF_MUSEE" column).

## Data cleaning and joining

### Year of interest: 2019

The freq data set only includes Muséofile references starting from 2019. The years following 2019 are highly impacted by Covid crisis. Then we don't account into account their years in our study, as they are not representative of the museum usual frequentation. 

We use the “filter” function and select only the year 2019 for the freq data base.

```{r}
freq <- freq |> filter(annee == 2019)
```

### Selecting variables of interest

First, we get rid of museums that don't have the frequentation data, represented by the variable NOTE (when either the museum is closed or the information is partially completed). 

So, we only select the museums whose NOTE variable is empty. 

```{r}
freq <- freq |> filter(is.na(note))
```

Then, we only keep the variables of interest, and drop the rest. The variables that we keep are:

1st data set Frequentation:
ID_MUSEOFILE
NOM_DU_MUSEE
REGIONS
VILLE
TOTAL
PAYANT; GRATUIT
NOMDEP

2nd data set Muséofile:
NOMOFF
DOMPAL
ARTISTE
PROT-ESP; PROT-BAT
LATITUDE; LONGITUDE

```{r}
freq <- freq |> select(id_museofile, nom_du_musee, regions, ville, total, payant, gratuit, nomdep)
museum <- museum |> select(nomoff, dompal, artiste, prot_bat, prot_esp, latitude, longitude)
```


